services:
  frontend:
    build:
      context: ./frontend
    ports:
      - "80:80"
    restart: unless-stopped
    networks:
      - mangoberry-net
    # env_file:
    #   - ./frontend/.env

  backend:
    build:
      context: .
      dockerfile: backend/Dockerfile
    ports:
      - "8000:8000"
    restart: unless-stopped
    networks:
      - mangoberry-net
    environment:
      AWS_DEFAULT_REGION: "ap-northeast-2"
      AWS_SECRET_ID: "prod/mangoberry/servicecontainer"
    # healthcheck:
    #   test: ["CMD", "curl", "-fsS", "http://localhost:8000/docs"]
    #   interval: 10s
    #   timeout: 3s
    #   retries: 12
    #   start_period: 10s

networks:
    mangoberry-net:
      driver: bridge